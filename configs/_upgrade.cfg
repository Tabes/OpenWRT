


### === REPOSITORY AVAILABILITY CHECK === ###
echo "Check Repository availability..."

if ! wget -q --spider http://downloads.openwrt.org/ --timeout=10; then
    echo "WARNING: OpenWrt Repository not reachable"
    echo "Internet connection or DNS problem possible"
    read -p "Continue anyway? (y/N): " CONTINUE
    
    if [ "$CONTINUE" != "y" ] && [ "$CONTINUE" != "Y" ]; then
        echo "Installation aborted - check your internet connection"
        exit 1
    fi
    
    echo "Trying to continue anyway..."
fi

### === PACKAGE REPOSITORY UPDATE === ###
echo "Updating package lists..."
opkg update

### === BASIC PACKAGES === ###
echo "Installing basic packages..."
opkg install wget curl nano htop iperf3

### === WIFI 7 PACKAGES === ###
echo "Installing WiFi 7 packages..."
opkg install kmod-mt7996 mt7996-firmware
opkg install hostapd-openssl wpa-supplicant-openssl
opkg install iw iwinfo wireless-tools

### === 5G MODEM PACKAGES === ###
echo "Installing 5G modem packages..."
opkg install kmod-usb-serial-option kmod-usb-serial-qualcomm
opkg install comgt usb-modeswitch kmod-mii kmod-usb-net
opkg install kmod-usb-net-cdc-mbim kmod-usb-net-cdc-ncm kmod-usb-net-cdc-ether
opkg install kmod-usb-net-qmi-wwan uqmi luci-proto-qmi
opkg install kmod-usb-net-rndis kmod-usb-serial-wwan kmod-usb-wdm

### === NETWORK TOOLS === ###
echo "Installing network tools..."
opkg install tcpdump nmap netcat socat
opkg install iptables-mod-extra kmod-ipt-extra

### === LUCI WEB INTERFACE === ###
echo "Installing LuCI web interface..."
opkg install luci luci-ssl-openssl
opkg install luci-app-firewall luci-mod-admin-full
opkg install luci-app-opkg luci-base luci-mod-network
opkg install luci-proto-qmi luci-app-commands

### === MONITORING AND DEBUG === ###
echo "Installing monitoring tools..."
opkg install bind-tools ca-certificates ca-bundle
